import csv
import re
from urllib.parse import urlparse

def extract_twitter_handle_or_false(url: str) -> str or bool: # type: ignore
    """
    Attempt to extract a Twitter/X handle from the given URL.
    If the URL is not a valid Twitter/X user profile link, return False.
    """
    # Prepend 'https://' if missing a scheme so that urlparse can parse correctly.
    if not url.lower().startswith(('http://', 'https://')):
        url = 'https://' + url
    
    parsed = urlparse(url)
    
    valid_domains = {"x.com", "twitter.com"}
    if parsed.netloc.lower() not in valid_domains:
        return False

    # The path (e.g., '/SomeHandle/') should have slashes stripped.
    path = parsed.path.strip("/")
    if not path:
        return False
    
    # If the path contains an additional slash, it's something like '/SomeHandle/status/...'
    if "/" in path:
        return False
    
    # Validate that the handle contains only letters, digits, or underscores.
    handle_pattern = re.compile(r'^[A-Za-z0-9_]+$')
    if not handle_pattern.match(path):
        return False
    
    return path

def main():
    # List of URLs (as provided)
    urls = [
        "https://x.com/nickjia25/status/1875563014482710573",
        "x.com/pepexbtai",
        "https://x.com/griffaindotcom/status/1875597766757646369",
        "https://x.com/snoo_ai/status/1875616360509927859",
        "https://x.com/Not_Scotti/status/1875580756535504921",
        "https://x.com/Not_Scotti/status/1875580756535504921",
        "https://niggaai.fun/",
        "https://x.com/Forbes/status/1875625761035460799",
        "https://x.com/brian_armstrong/status/1844040530621272279",
        "https://x.com/GamedayCulture/status/1875611416272761024",
        "https://x.com/CincinnatiZoo/status/1875633334157496478",
        "https://x.com/abidjan_net/status/1875648921747517704",
        "x.com/echoAGNT",
        "https://x.com/rawsalerts/status/1875659076660822092",
        "https://x.com/rawsalerts/status/1875659076660822092",
        "https://x.com/i/events/1367261664538619907",
        "https://x.com/i/grok/share/EUN2AFSdDku4Wtvtpik8cIdEl",
        "x.com/Inderji25835235",
        "https://x.com/i/events/1367261664538619907",
        "https://x.com/rawsalerts/status/1875659076660822092",
        "https://x.com/DonaldJTrumpJr/status/1875678889818911216",
        "https://www.tiktok.com/@peznaranja_/video/7452053043798985990",
        "https://x.com/wedtm/status/1875584481903640684",
        "https://x.com/i/communities/1875686947584446693",
        "https://x.com/i/grok/share/EUN2AFSdDku4Wtvtpik8cIdEl",
        "https://x.com/G0ADM/status/1875237734891331838",
        "x.com/SentiumAI",
        "https://x.com/bgatesisapyscho/status/1874138111254368540?s=46",
        "https://x.com/AndyAyrey/status/1875122335621185725?t=vIr4NT2vCSE3odFA_d_ZIg&s=19",
        "https://x.com/beaniemaxi/status/1875702021610951132",
        "https://x.com/elonmusk/status/1875723605344186562",
        "https://x.com/idolly_AI/status/1866830294138929544",
        "https://x.com/Dexerto/status/1875547920201871494",
        "https://x.com/glamsystems/status/1871395397400486260",
        "https://x.com/AgentStationAI/status/1875620739547852897",
        "https://x.com/Mosaia_io/status/1851772937075900707",
        "https://x.com/bumbacatcoin/status/1868717725130149996",
        "https://x.com/elonmusk/status/1875755115245924663",
        "https://x.com/alx/status/1875755996188176792",
        "https://x.com/TheClipBot/status/1875757482855084092",
        "https://x.com/AlkahestMu/status/1875732976773812428",
        "https://ainuclearenergy.fun/",
        "https://x.com/UndisclosedDocs/status/1875762642356506909",
        "https://x.com/frankdegods/status/1875784465706053686",
        "https://brand.github.com/graphic-elements/mascots",
        "https://brand.github.com/graphic-elements/mascots",
        "https://x.com/cryptoxhe/status/1875801207488258382",
        "https://x.com/trypearai/status/1844171058888462722",
        "https://x.com/i/spaces/1RDGlygPBBoJL",
        "https://x.com/kevin__russell/status/1875770171593568567",
        "undefined",
        "https://x.com/github/status/1875614479322386818?t=yMemTwS4H_uPx3C7bik85A&s=19",
        "https://x.com/opus_genesis/status/1875811067382628812",
        "https://x.com/cb_doge/status/1875868800945639931",
        "https://x.com/truth_terminal/status/1809449977841873310?t=a27LJgkjDPuiIT8n8gzTXg&s=19",
        "https://x.com/0xzerebro/status/1875890486658937332?s=46",
        "x.com/thred_dot_ai",
        "https://x.com/KrisKimmerle_/status/1875901544073465914",
        "https://x.com/elonmusk/status/1875921852683661590",
        "https://x.com/kb24x7/status/1875913694083006501",
        "https://x.com/elonmusk/status/1875934421507039302",
        "https://x.com/restrictedreels/status/1875728105224204444",
        "X:https://x.com/GSGB01",
        "https://x.com/CookerFlips/status/1875950737777361181",
        "https://www.youtube.com/channel/UCVzLLZkDuFGAE2BGdBuBNBg",
        "https://www.tiktok.com/@cocomelon/video/7382894737549790497?_r=1&_t=ZP-8sol1E9nhl9",
        "https://x.com/VitalikButerin/status/1875954528383914457",
        "https://x.com/mr_benft/status/1875963400184062106",
        "https://www.circleonshape.network/",
        "https://x.com",
        "https://x.com/mr_benft/status/1875963400184062106",
        "https://x.com/mr_benft/status/1875963400184062106",
        "https://x.com/mr_benft/status/1875963400184062106",
        "https://www.geocachingtoolbox.com/index.php?lang=en&page=hexahue",
        "https://www.youtube.com/@AiAgentChad",
        "x.com/WeWillBuildIt",
        "https://x.com/elonmusk/status/1876157387180228666",
        "https://x.com/supermeme_ai/status/1495616543027339270",
        "https://x.com/elonmusk/status/1876161861269557275",
        "https://x.com/elonmusk/status/1876168991330439314",
        "https://x.com/elonmusk/status/1876176598858362937",
        "https://x.com/elonmusk/status/1876178691761574005",
        "https://www.youtube.com/watch?v=X7HmltUWXgs",
        "https://x.com/IrinaValko7920/status/1858117141544763582#:~:text=granddaughter%20Sophie",
        "https://x.com/stlzoo/status/1875568392125477157",
        "https://x.com/irinavalko7920/status/1858117141544763582",
        "https://x.com/IrinaValko7920/status/1875388988233806041",
        "https://x.com/swarms_corp/status/1864777505372061757",
        "undefined",
        "https://x.com/Bitcoin/status/1876263280076857781",
        "https://x.com/DonaldJTrumpJr/status/1876274846101118978",
        "https://x.com/ZyphraAI/status/1845939850958327822",
        "https://x.com/MarioNawfal/status/1876287609275650403",
        "x.com/ADAWifeLover",
        "https://x.com/DonaldJTrumpJr/status/1848129785102250288",
        "undefined",
        "undefined",
        "https://x.com/shawmakesmagic/status/1876297078709874768",
        "https://x.com/yoxics/status/1875301874968228282",
        "https://x.com/slingdeez/status/1876308969393987699",
        "https://x.com/jackbutcher/status/1876311046476214424",
        "x.com/pmtateuk",
        "https://x.com/SHL0MS/status/1876328006559395882",
        "https://www.infinitebackrooms.com/dreams/conversation-1722038377-scenario-terminal-of-truths-txt",
        "https://x.com/Enron/status/1876343167630594287",
        "https://x.com/Cobratate/status/1876344166944477574",
        "x.com/Pijall1",
        "https://x.com/B3nHawkins/status/1876340482688897495",
        "https://x.com/AIHegemonyMemes/status/1846383239684063507/photo/1",
        "https://x.com/Enron/status/1876343167630594287",
        "https://x.com/BasedSatori/status/1876343428453437498",
        "https://x.com/cb_doge/status/1876357690844438634",
        "https://x.com/nypost/status/1876358470443647082",
        "https://www.votebruv.co.uk/",
        "https://x.com/repligate/status/1853369114200576075",
        "https://x.com/nicksortor/status/1876366962084937867",
        "https://x.com/LAZoo42069/status/1876371353667822079",
        "https://x.com/noveltokens/status/1793864819151618237",
        "https://x.com/dharma_ai/status/1876364040374800677",
        "https://x.com/@ZapAlpha_",
        "https://twitter.com/intent/user?screen_name=AiTubeLive",
        "x.com/consequently",
        "https://www.infinitebackrooms.com.co/dreams/conversation-1722040179-scenario-terminal-of-truths-txt",
        "https://x.com/tonyplasencia3/status/1876447813468582201",
        "x.com/ai6900z_",
        "https://x.com/elonmusk/status/1876453996245787056",
        "https://x.com/pumpdotscience/status/1876461316677964216",
        "https://x.com/nizoai/status/1871445305696395650",
        "https://x.com/davfilmsx3/status/1368059129626058765",
        "https://twitter.com/0xzerebro/status/1875739201955565685",
        "https://www.youtube.com/live/k82RwXqZHY8",
        "https://x.com/anurag__kochar/status/1873740537532236051",
        "https://www.x.com/e2bai",
        "https://x.com/noveltokens/status/1866392567224635711?s=46",
        "https://x.com/Purring_Lynx/status/1876611616063852646",
        "https://x.com/i/lists/1876603623326855352",
        "https://x.com/therecordorange/status/1876621950426259644?s=46&t=L1sReaVY-L8fzfhwrUW6Wg",
        "https://x.com/megs_io/status/1847772215132958783",
        "https://x.com/theswan_dharma/status/1876621301072478470",
        "https://x.com/hollanderadam/status/1876641005115691294",
        "https://x.com/Cobratate/status/1876645732117258306",
        "https://x.com/Cobratate/status/1876645732117258306",
        "https://x.com/rock_agent_ ",
        "https://x.com/DeItaone/status/1876672922049528209",
        "https://x.com/stephain_art/status/1876643495307551093",
        "https://twitter.com/repligate/status/1849017956832801261?s=61&t=mWX8UjxwdAq0Gji5z9DaNA",
        "https://x.com/HeygenLabs_ ",
        "https://x.com/stephain_art/status/1876643495307551093",
        "https://x.com/mashable/status/1876688799956390221",
        "https://x.com/nypost/status/1876695675007643967",
        "https://twitter.com/nypost/status/1876695675007643967",
        "https://x.com/i/broadcasts/1zqKVYPoZaMxB",
        "https://x.com/elonmusk/status/1876697674264813998",
        "https://x.com/nocontextfooty/status/1875578264871432269?s=46",
        "https://x.com/elonmusk/status/1876700763302355121",
        "https://x.com/RedQueenAgent/status/1876699004722991260",
        "x.com/aeroaitrade",
        "https://x.com/i/broadcasts/1zqKVYPoZaMxB",
        "https://x.com/elonmusk/status/1876697674264813998",
        "https://x.com",
        "https://callofduty.fandom.com/wiki/Highrise",
        "https://x.com/elonmusk/status/1876723933744927047",
        "x.com/Pijall1",
        "https://x.com/memedustry/status/1876735563925205495",
        "https://x.com/elonmusk/status/1876737326660862213",
        "https://x.com/i/communities/1876725361368789425",
        "https://x.com/noveltokens/status/1795290032011612504",
        "https://x.com/intent/post?text=%24SBMM%20Skill%20Based%20Money%20Making%20-%20Forget%201v1%20on%20Rust%2C%20it%27s%20time%20for%201v1%20in%20money%20making",
        "https://x.com/mashable/status/1876591114913730848",
        "https://x.com",
        "https://x.com/MarioNawfal/status/1876763398899401077",
        "https://x.com/Banks/status/1876767253359730886",
        "https://x.com/sama/status/1876780763653263770",
        "x.com",
        "https://x.com/sama/status/1876780763653263770/photo/1",
        "https://x.com/sama/status/1876780763653263770",
        "https://x.com/sama/status/1876780763653263770",
        "https://x.com/LaraLeaTrump/status/1876784713827840424",
        "https://x.com/AndyAyrey/status/1829646672252805266",
        "https://x.com/ZooNewsJapan/status/1876778845476368440",
        "https://x.com/i/communities/1876668267550417097",
        "https://x.com/AtlasAgents_/status/1876483493733007566",
        "https://x.com/intent/post?text=Just+A+PVE+Runner",
        "https://x.com/JIMMYEDGAR/status/1876739809756217620",
        "https://x.com/i/communities/1876807349085647168",
        "https://x.com/Banks/status/1876811309703897197",
        "https://x.com/Banks/status/1876811309703897197",
        "https://x.com/Banks/status/1876811309703897197",
        "https://x.com/Banks/status/1876811309703897197",
        "https://x.com/ujjwalgupta49/status/1876645025200975969",
        "x.com/pragma_solana",
        "https://x.com/Synapffun/status/1876831576849358942",
        "https://x.com/ujjwalgupta49/status/1515736323641937920",
        "https://x.com/noveltokens/status/1876840796751794281",
        "https://www.x.com/transactlink",
        "https://x.com/AndyAyrey/status/1814174024781775012",
        "https://x.com/Bitcoin/status/1874813650491318474",
        "https://x.com/JupiterExchange/status/1874817314815943114",
        "https://x.com/selyuk_art/status/1871424807943934274?s=46",
        "https://x.com/ScuderiaFerrari/status/1874830143207948713",
        "https://x.com/MarioNawfal/status/1874848269286981695",
        "https://x.com/MarioNawfal/status/1874844858482917710",
        "https://azamisolana.xyz/",
        "https://x.com/RaoulGMI/status/1845776006159700303/photo/1",
        "https://x.com/geeknik/status/1852805006686405050/photo/1",
        "https://x.com/elonmusk/status/1874862847123165557",
        "https://x.com/mikecollinsga/status/1494688882411159553?s=46",
        "https://x.com/Shirley__AI/status/1874863745970905374",
        "https://x.com/WatcherGuru/status/1874865494324650205",
        "https://x.com/intent/post?text=Fuck+you+@IRS,+I%27m+not+paying+that+shit!+$NTOC",
        "https://x.com/accuweather/status/1874829332633514327?t=uqUJ9cmz2lUsVMuwEypVew&s=19",
        "https://x.com/elonmusk/status/1874871236653932664?t=uYYmkQenS4vqfjME4N44zw&s=19",
        "https://x.com/dogeofficialceo/status/1870865928097042906",
        "https://x.com/RadioGenoa/status/1874736747017629851",
        "@YamiWarrior",
        "https://x.com/solanadali/status/1874879294515904656?s=46&t=Xib0bitdVzp4YJrNe793iw",
        "https://x.com/nypost/status/1874882644581745074",
        "https://x.com/wedtm/status/1671358867681288194",
        "https://x.com/nypost/status/1874883147155792026",
        "https://x.com/nypost/status/1874882644581745074",
        "https://www.oge.gov/web/oge.nsf/News+Releases/DECB4A1E3270471785258A3700681B21/$FILE/LA-23-12%20-%20Identifying%20and%20Preventing%20Violations%20of%2018%20U.S.C.%20208%20Arising%20from%20Digital%20Asset%20Ownership.pdf#page=4",
        "https://x.com/i/communities/1874871008332755178",
        "https://x.com/cb_doge/status/1874952610089926800",
        "https://x.com/cb_doge/status/1874952610089926800",
        "https://x.com/elonmusk/status/1874962471569781189",
        "https://x.com/elonmusk/status/1874956869061791745",
        "https://x.com/0xzerebro/status/1874971822652862619",
        "https://x.com/user9320312/status/1855404897233215692",
        "https://x.com/tonyplasencia3/status/1871592237274120404",
        "https://www.x.com/hivegateway",
        "https://x.com/trencher1943/status/1874998534749217160",
        "https://www.twitch.tv/chantygirl333",
        "https://x.com/voltrxyz/status/1869763995923833185",
        "https://x.com/muditasol/status/1875008873129775129",
        "https://x.com/chantygirl333/status/1875021689131843590",
        "https://x.com/elonmusk/status/1875021507824390209",
        "https://x.com/PulsebotAI/status/1874761936371667207",
        "https://x.com/mezoteric/status/1875023358481637591",
        "https://x.com/USATODAY/status/1875026814487114235",
        "https://x.com/i/grok/share/R6uS6Y5akmPn4Q6021kmpKYSC",
        "https://www.x.com/modallabs",
        "https://x.com/griffaindotcom/status/1875050923422319009",
        "https://x.com/koreanquant1/status/1875051075188994486",
        "https://x.com/rawsalerts/status/1875045301293023461",
        "https://krebsonsecurity.com/2024/11/hacker-in-snowflake-extortions-may-be-a-u-s-soldier/",
        "https://x.com/elonmusk/status/1875052197433786743",
        "https://x.com/1000glockstare/status/1874380463391014968",
        "https://x.com/noveltokens/status/1864553402648158261",
        "https://x.com/FynixAI/status/1875059795910365679",
        "https://x.com/anon_rip/status/1875059073089196453",
        "https://x.com/truth_terminal/status/1875075045145346306",
        "https://www.x.com/hypernodeai",
        "https://twitter.com/elonmusk/status/1875136149565686249",
        "https://x.com/beeple/status/1875145397334856090",
        "https://x.com/DegenerateNews/status/1875146806751003121",
        "https://x.com/elonmusk/status/1875150194909823085",
        "https://x.com/0xzerebro/status/1875161969470165243",
        "https://x.com/truth_terminal/status/1824771260401791047",
        "undefined",
        "https://x.com/0xNoushad/status/1875218440778313936",
        "https://x.com/mytutorai/status/1875221806489202873",
        "https://x.com/0xzerebro/status/1852811649096274428/photo/1",
        "https://x.com/agent_2075 ",
        "https://x.com/CorporealCasey/status/1855388986438459527",
        "https://x.com/presleyplz/status/1875228101392969834",
        "https://twitter.com/ownthedoge/status/1875238273842606400",
        "x.com/Basital39824155",
        "https://x.com/deanmlittle/status/1875253544649146728",
        "https://x.com/deanmlittle/status/1875136565456109891?s=46",
        "https://x.com/deanmlittle/status/1875136565456109891?s=46",
        "https://x.com/deanmlittle/status/1821972462869029182",
        "https://x.com/i/communities/1875231974610104727",
        "https://x.com/CincinnatiZoo/status/1875270952033931282",
        "https://x.com/solana/status/1875278257903562882",
        "https://x.com/BRICSinfo/status/1875222682385698950",
        "undefined",
        "https://x.com/alx/status/1875284742276616207",
        "https://x.com/MarioNawfal/status/1875284985889910797",
        "https://x.com/KNWAFOX24/status/1875287736984211885",
        "x.com/textmorgan",
        "https://x.com/xNiner0/status/1875314375441178892",
        "https://www.x.com/nodeifyai",
        "https://www.x.com/BazookaWicks",
        "https://shorturl.at/rjvw1",
        "https://x.com/hugomanteau/status/1875318141032833190?s=46",
        "https://babylonlabs.io/",
        "https://x.com/nypost/status/1875445151545348482",
        "https://x.com/BrianknowsAI/status/1871186518901153882",
        "https://x.com/aolo_ai/status/1870857300661166507",
        "https://x.com/bittensorai/status/1873468518337040780",
        "https://x.com/FlowAI_xyz/status/1865777454473720003",
        "www.x.com/singlemomcoin_",
        "https://x.com/0xzerebro/status/1875491653462716518",
        "https://x.com/VastAIResearch/status/1865744425475092521",
        "https://x.com/fission_web3/status/1871430951718576213",
        "https://x.com/notch/status/1875230756437479658",
        "https://x.com/elonmusk/status/1875520043662164148",
        "https://x.com/elonmusk/status/1875520043662164148",
        "https://x.com/elonmusk/status/1875520043662164148",
        "https://x.com/elonmusk/status/1875520043662164148?s=46",
        "https://www.x.com/promelabsapp/",
        "https://www.x.com/promelabsapp/",
        "https://x.com/mayemusk/status/1817034453644116212",
    ]

    # Open a CSV file to write results
    with open("output.csv", "w", newline="", encoding="utf-8") as f:
        writer = csv.writer(f)
        # Write header row
        writer.writerow(["URL", "Extracted_Handle"])
        
        # Process each URL
        for url in urls:
            handle = extract_twitter_handle_or_false(url)
            writer.writerow([url, handle])

if __name__ == "__main__":
    main()
